---
layout: post
title: React.js学习
tag: 技术
keywords: React
---

文章开头总是不知道怎么写，想了5分钟也想不出来，那我还是就直接写吧。

React是我学前端以来一直想学的框架，毕竟facebook开发的对吧，高大上。哈哈。虽然一直想学，但是我自己还是想等我自己的基础打的扎实一点再去学习。所以一直拖到了现在。

现在自己每天在有空的时候学习React和node，并打算做一个小小的博客网站。也算是一个操练这2个工具的小项目。当然刚开始学，肯定会遇到很多问题，我就把React相关的坑或者是自己疏忽的地方记录在这里！


## router参数获取的方式
因为之前使用的是Vue，对于router可以在组件中直接通过`this.$router`来获得相关数据，但是在React中，如果要操控路由，想获得router的参数有点麻烦，我一开始是一层一层传递给子组件。但是后来看到了context，虽然官网一直说不要用少用，但是既然React Router V4都是采用这个实现，那我也用这个获取下router应该也无碍了。  
在React Router V4中因为router中会默认设置childContextTypes和getChildContext，所以只要在你任何想要router参数的组件中，写下如下代码：
```js
  const PropTypes = require('prop-types');

  class componentName extends React.Component {
    componentDidMount () {
      console.log(this.context.router)   // 即可获取到
    }

    .........
  }

  componentName.contextTypes = {
    router: PropTypes.object
  };

```


## create-react-app 构建项目，配置css-loader,sass-loader,antd

首先使用create-react-app构建相项目，然后`yarn eject`暴露出原本隐藏的配置文件(config文件中)。

然后配置css-loader：  
```js
          {
            //因为要配置antd，不能将模块中的css模块化，否则会出现无法渲染的情况
            //因为要配置scss，所以要加上scss
            test: /(\.scss|\.css)$/,
            exclude: /node_modules|antd\.css/,
            use: [
              'style-loader',
              {
                loader: 'css-loader',
                options: {
                  importLoaders: 2,
                  modules: true,     // 开启css-loader的modules功能
                  localIdentName: '[name]__[local]__[hash:base64:5]',    // 定义模块后的命名格式
                },
              },
              {
                loader: require.resolve('postcss-loader'),
                options: {
                  // Necessary for external CSS imports to work
                  // https://github.com/facebookincubator/create-react-app/issues/2677
                  ident: 'postcss',
                  plugins: () => [
                    require('postcss-flexbugs-fixes'),
                    autoprefixer({
                      browsers: [
                        '>1%',
                        'last 4 versions',
                        'Firefox ESR',
                        'not ie < 9', // React doesn't support IE8 anyway
                      ],
                      flexbox: 'no-2009',
                    }),
                  ],
                },
              },
              // 这个和关键，让modules功能能识别scss的文件
              'sass-loader',  
            ],
          },
          {
            // 配置antd的css-loader
            test: /(\.scss|\.css)$/,
            include: /node_modules|antd\.css/,
            use: [
              require.resolve('style-loader'),
              {
                loader: require.resolve('css-loader'),
                options: {
                  importLoaders: 1,
                },
              },
            ],
          },
```

接着配置antd：

官网上给出的方法是在使用create-react-app后使用`react-app-rewire-less` 插件来给配置文件添加内容，但是当我们暴露配置文件后就不需要这么操作了，我们可以直接将内容添加进去。

```js
      {
        test: /\.(js|jsx|mjs)$/,
        enforce: 'pre',
        use: [
          {
            // 添加antd的相关配置，注意这里要写在eslint-loader之前，否则会报错
            loader: require.resolve('babel-loader'),
            options: {
              plugins: [
              ['import', { libraryName: 'antd', libraryDirectory: 'es', style: 'css' }],
              ],
            },
          },
          {
            options: {
              formatter: eslintFormatter,
              eslintPath: require.resolve('eslint'),
            },
            loader: require.resolve('eslint-loader'),
          },
        ],
        include: paths.appSrc,
      },
```

最后配置sass-loader：

```js
          {
            // Exclude `js` files to keep "css" loader working as it injects
            // it's runtime that would otherwise processed through "file" loader.
            // Also exclude `html` and `json` extensions so they get processed
            // by webpacks internal loaders.
            exclude: [/\.js$/, /\.html$/, /\.json$/, /\.scss$/,],   // 在这里添加scss格式，让他不使用file-loader
            loader: require.resolve('file-loader'),
            options: {
              name: 'static/media/[name].[hash:8].[ext]',
            },
          },

          // 接着添加scss的配置内容
          {
            test: /\.scss$/,
            loaders: ['style-loader', 'css-loader', 'sass-loader'],
          },
```

至此，相关的配置内容都已经完成啦，以后有新的我再更新~

